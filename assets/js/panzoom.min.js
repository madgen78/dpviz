!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).panzoom=e()}(function(){return function o(r,i,a){function c(n,e){if(!i[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);throw(t=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",t}t=i[n]={exports:{}},r[n][0].call(t.exports,function(e){return c(r[n][1][e]||e)},t,t.exports,o,r,i,a)}return i[n].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)c(a[e]);return c}({1:[function(e,n,t){"use strict";var de=e("wheel"),pe=e("amator"),he=e("ngraph.events"),ve=e("./lib/kinetic.js"),o=e("./lib/createTextSelectionInterceptor.js"),ye=o(),ge=o(!0),we=e("./lib/transform.js"),xe=e("./lib/svgController.js"),be=e("./lib/domController.js"),Ee=1,Ce=1.75,Te=300;function u(e,t){var c=(t=t||{}).controller;if(c||(e instanceof SVGElement&&(c=xe(e,t)),e instanceof HTMLElement&&(c=be(e,t))),!c)throw new Error("Cannot create panzoom for the current type of dom element");var u=c.getOwner(),a={x:0,y:0},n=!1,f=new we;c.initTransform&&c.initTransform(f);var o,i="function"==typeof t.filterKey?t.filterKey:Ae,s="number"==typeof t.pinchSpeed?t.pinchSpeed:1,r=t.bounds,l="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,m="number"==typeof t.minZoom?t.minZoom:0,d="number"==typeof t.boundsPadding?t.boundsPadding:.05,p="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:Ce,h=t.beforeWheel||Ae,v=t.beforeMouseDown||Ae,y="number"==typeof t.zoomSpeed?t.zoomSpeed:Ee,g=Se(t.transformOrigin),w=t.enableTextSelection?ge:ye;!function(e){var n=typeof e;if("undefined"!=n&&"boolean"!=n&&!(ke(e.left)&&ke(e.top)&&ke(e.bottom)&&ke(e.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}(r),t.autocenter&&function(){var e,n,t=0,o=0,r=q();n=r?(t=r.left,o=r.top,e=r.right-r.left,r.bottom-r.top):(i=u.getBoundingClientRect(),e=i.width,i.height);var i,a=c.getBBox();0!==a.width&&0!==a.height&&(r=n/a.height,i=e/a.width,r=Math.min(i,r),f.x=-(a.left+a.width/2)*r+e/2+t,f.y=-(a.top+a.height/2)*r+n/2+o,f.scale=r)}();var x,b,E,C,T,S,A=0,k=!1,M=!1,L="smoothScroll"in t&&!t.smoothScroll?{start:Ae,stop:Ae,cancel:Ae}:ve(function(){return{x:f.x,y:f.y}},function(e,n){ce(),z(e,n)},t.smoothScroll),j=!1;R();var F={dispose:function(){V()},moveBy:P,moveTo:z,centerOn:function(e){var n=e.ownerSVGElement;if(!n)throw new Error("ui element is required to be within the scene");var t=e.getBoundingClientRect(),e=t.left+t.width/2,t=t.top+t.height/2,n=n.getBoundingClientRect(),e=n.width/2-e,t=n.height/2-t;P(e,t,!0)},zoomTo:ae,zoomAbs:Z,smoothZoom:re,smoothZoomAbs:function(n,t,e){var o={scale:f.scale},e={scale:e};L.cancel(),ce(),T=pe(o,e,{step:function(e){Z(n,t,e.scale)}})},showRectangle:function(e){var n=u.getBoundingClientRect(),t=B(n.width,n.height),o=e.right-e.left,r=e.bottom-e.top;if(!Number.isFinite(o)||!Number.isFinite(r))throw new Error("Invalid rectangle");var i=t.x/o,n=t.y/r,n=Math.min(i,n);f.x=-(e.left+o/2)*n+t.x/2,f.y=-(e.top+r/2)*n+t.y/2,f.scale=n},pause:function(){V(),j=!0},resume:function(){j&&(R(),j=!1)},isPaused:function(){return j},getTransform:function(){return f},getMinZoom:function(){return m},setMinZoom:function(e){m=e},getMaxZoom:function(){return l},setMaxZoom:function(e){l=e},getTransformOrigin:function(){return g},setTransformOrigin:function(e){g=Se(e)},getZoomSpeed:function(){return y},setZoomSpeed:function(e){if(!Number.isFinite(e))throw new Error("Zoom speed should be a number");y=e}};return he(F),F;function B(e,n){var t,o,r,i;return c.getScreenCTM?(t=(i=c.getScreenCTM()).a,o=i.d,r=i.e,i=i.f,a.x=e*t-r,a.y=n*o-i):(a.x=e,a.y=n),a}function z(e,n){f.x=e,f.y=n,O(),me("pan"),N()}function D(e,n){z(f.x+e,f.y+n)}function O(){var e=q();if(e){var n,t=!1,n=(n=c.getBBox(),{left:(o=function(e,n){return{x:e*f.scale+f.x,y:n*f.scale+f.y}}(n.left,n.top)).x,top:o.y,right:n.width*f.scale+o.x,bottom:n.height*f.scale+o.y}),o=e.left-n.right;return 0<o&&(f.x+=o,t=!0),(o=e.right-n.left)<0&&(f.x+=o,t=!0),0<(o=e.top-n.bottom)&&(f.y+=o,t=!0),(o=e.bottom-n.top)<0&&(f.y+=o,t=!0),t}}function q(){if(r){if("boolean"!=typeof r)return r;var e=u.getBoundingClientRect(),n=e.width,e=e.height;return{left:n*d,top:e*d,right:n*(1-d),bottom:e*(1-d)}}}function N(){n=!0,o=window.requestAnimationFrame(W)}function I(e,n,t){if(Me(e)||Me(n)||Me(t))throw new Error("zoom requires valid numbers");var o=f.scale*t;if(o<m){if(f.scale===m)return;t=m/f.scale}if(l<o){if(f.scale===l)return;t=l/f.scale}n=B(e,n);f.x=n.x-t*(n.x-f.x),f.y=n.y-t*(n.y-f.y),r&&1===d&&1===m?(f.scale*=t,O()):O()||(f.scale*=t),me("zoom"),N()}function Z(e,n,t){I(e,n,t/f.scale)}function P(e,n,t){if(!t)return D(e,n);C&&C.cancel();var o=0,r=0;C=pe({x:0,y:0},{x:e,y:n},{step:function(e){D(e.x-o,e.y-r),o=e.x,r=e.y}})}function R(){u.addEventListener("mousedown",J,{passive:!1}),u.addEventListener("dblclick",_,{passive:!1}),u.addEventListener("touchstart",G,{passive:!1}),u.addEventListener("keydown",Y,{passive:!1}),de.addWheelListener(u,te,{passive:!1}),N()}function V(){de.removeWheelListener(u,te),u.removeEventListener("mousedown",J),u.removeEventListener("keydown",Y),u.removeEventListener("dblclick",_),u.removeEventListener("touchstart",G),o&&(window.cancelAnimationFrame(o),o=0),L.cancel(),ee(),ne(),w.release(),se()}function W(){n&&(n=!1,c.applyTransform(f),me("transform"),o=0)}function Y(e){var n,t=0,o=0,r=0;38===e.keyCode?o=1:40===e.keyCode?o=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?r=1:187!==e.keyCode&&107!==e.keyCode||(r=-1),i(e,t,o,r)||((t||o)&&(e.preventDefault(),e.stopPropagation(),n=u.getBoundingClientRect(),P(.05*(n=Math.min(n.width,n.height))*t,.05*n*o)),r&&(o=ue(100*r),ae((n=g?ie():{x:(r=u.getBoundingClientRect()).width/2,y:r.height/2}).x,n.y,o)))}function G(e){var n;if(n=e,!void(t.onTouch&&!t.onTouch(n)||(n.stopPropagation(),n.preventDefault())),1===e.touches.length)return function(e){e=oe(e.touches[0]);x=e.x,b=e.y,L.cancel(),K()}(e,e.touches[0]);2===e.touches.length&&(E=X(e.touches[0],e.touches[1]),S=!0,K())}function K(){k||(k=!0,document.addEventListener("touchmove",U),document.addEventListener("touchend",H),document.addEventListener("touchcancel",H))}function U(e){var n,t,o,r,i;1===e.touches.length?(e.stopPropagation(),n=(r=B((i=oe(e.touches[0])).x,i.y)).x-x,t=r.y-b,0!=n&&0!=t&&fe(),x=r.x,b=r.y,P(n,t)):2===e.touches.length&&(S=!0,t=1+((n=X(o=e.touches[0],r=e.touches[1]))/E-1)*s,o=oe(o),r=oe(r),x=(o.x+r.x)/2,b=(o.y+r.y)/2,g&&(i=ie(),x=i.x,b=i.y),ae(x,b,t),E=n,e.stopPropagation(),e.preventDefault())}function H(e){var n;0<e.touches.length?(n=oe(e.touches[0]),x=n.x,b=n.y):((e=new Date)-A<Te&&(g?re((n=ie()).x,n.y,p):re(x,b,p)),A=e,k=!1,se(),ne())}function X(e,n){var t=e.clientX-n.clientX,n=e.clientY-n.clientY;return Math.sqrt(t*t+n*n)}function _(e){var n;n=e,t.onDoubleClick&&!t.onDoubleClick(n)||(n.preventDefault(),n.stopPropagation());e=oe(e);g&&(e=ie()),re(e.x,e.y,p)}function J(e){if(!v(e)){if(k)return e.stopPropagation(),!1;if(1===e.button&&null!==window.event||0===e.button){L.cancel();var n=oe(e),n=B(n.x,n.y);return x=n.x,b=n.y,document.addEventListener("mousemove",Q),document.addEventListener("mouseup",$),w.capture(e.target||e.srcElement),!1}}}function Q(e){var n,t;k||(fe(),e=(n=B((t=oe(e)).x,t.y)).x-x,t=n.y-b,x=n.x,b=n.y,P(e,t))}function $(){w.release(),se(),ee()}function ee(){document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",$),M=!1}function ne(){document.removeEventListener("touchmove",U),document.removeEventListener("touchend",H),document.removeEventListener("touchcancel",H),S=M=!1}function te(e){var n,t;h(e)||(L.cancel(),t=e.deltaY,0<e.deltaMode&&(t*=100),1!==(n=ue(t))&&(ae((t=g?ie():oe(e)).x,t.y,n),e.preventDefault()))}function oe(e){var n=u.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}function re(n,t,e){var o=f.scale,r={scale:o},o={scale:e*o};L.cancel(),ce(),T=pe(r,o,{step:function(e){Z(n,t,e.scale)},done:le})}function ie(){var e=u.getBoundingClientRect();return{x:e.width*g.x,y:e.height*g.y}}function ae(e,n,t){return L.cancel(),ce(),I(e,n,t)}function ce(){T&&(T.cancel(),T=null)}function ue(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(y*e/128))}function fe(){M||(me("panstart"),M=!0,L.start())}function se(){M&&(S||L.stop(),me("panend"))}function le(){me("zoomend")}function me(e){F.fire(e,F)}}function Se(e){if(e)return"object"==typeof e?(ke(e.x)&&ke(e.y)||r(e),e):void r()}function r(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join("\n"))}function Ae(){}function ke(e){return Number.isFinite(e)}function Me(e){return Number.isNaN?Number.isNaN(e):e!=e}n.exports=u,function(){if("undefined"!=typeof document){var e=document.getElementsByTagName("script");if(e){for(var o,r,i,a,n=0;n<e.length;++n){var t=e[n];if(t.src&&t.src.match(/\bpanzoom(\.min)?\.js/)){o=t;break}}!o||(r=o.getAttribute("query"))&&(i=o.getAttribute("name")||"pz",a=Date.now(),function e(){var n=document.querySelector(r);if(!n){var t=Date.now(),t=t-a;return t<2e3?void setTimeout(e,100):void console.error("Cannot find the panzoom element",i)}var t=c(o);console.log(t);window[i]=u(n,t)}())}}function c(e){for(var n=e.attributes,t={},o=0;o<n.length;++o){var r=function(e){if(!e.name)return;if("p"!==e.name[0]||"z"!==e.name[1]||"-"!==e.name[2])return;var n=e.name.substr(3),e=JSON.parse(e.value);return{name:n,value:e}}(n[o]);r&&(t[r.name]=r.value)}return t}}()},{"./lib/createTextSelectionInterceptor.js":2,"./lib/domController.js":3,"./lib/kinetic.js":4,"./lib/svgController.js":5,"./lib/transform.js":6,amator:7,"ngraph.events":9,wheel:10}],2:[function(e,n,t){function i(e){return e.stopPropagation(),!1}function a(){}n.exports=function(e){if(e)return{capture:a,release:a};var n,t,o,r=!1;return{capture:function(e){r=!0,t=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=i,(n=e).ondragstart=i},release:function(){if(!r)return;r=!1,window.document.onselectstart=t,n&&(n.ondragstart=o)}}}},{}],3:[function(e,n,t){n.exports=function(n,e){if(!(n instanceof HTMLElement))throw new Error("svg element is required for svg.panzoom to work");var t=n.parentElement;if(!t)throw new Error("Do not apply panzoom to the detached DOM element. ");n.scrollTop=0,e.disableKeyboardInteraction||t.setAttribute("tabindex",0);return{getBBox:function(){return{left:0,top:0,width:n.clientWidth,height:n.clientHeight}},getOwner:function(){return t},applyTransform:function(e){n.style.transformOrigin="0 0 0",n.style.transform="matrix("+e.scale+", 0, 0, "+e.scale+", "+e.x+", "+e.y+")"}}}},{}],4:[function(e,n,t){(function(x){n.exports=function(r,i,e){"object"!=typeof e&&(e={});var a,c,u,f,s,l,m,d,p,h,n="number"==typeof e.minVelocity?e.minVelocity:5,t="number"==typeof e.amplitude?e.amplitude:.25,o="function"==typeof e.cancelAnimationFrame?e.cancelAnimationFrame:"function"==typeof x.cancelAnimationFrame?x.cancelAnimationFrame:clearTimeout,v="function"==typeof e.requestAnimationFrame?e.requestAnimationFrame:"function"==typeof x.requestAnimationFrame?x.requestAnimationFrame:function(e){return setTimeout(e,16)},y=342;return{start:function(){a=r(),l=p=f=m=0,c=new Date,o(u),o(h),u=v(g)},stop:function(){o(u),o(h);var e=r();s=e.x,d=e.y,c=Date.now(),(f<-n||n<f)&&(s+=l=t*f);(m<-n||n<m)&&(d+=p=t*m);h=v(w)},cancel:function(){o(u),o(h)}};function g(){var e=Date.now(),n=e-c;c=e;var t=r(),o=t.x-a.x,e=t.y-a.y;a=t;n=1e3/(1+n);f=.8*o*n+.2*f,m=.8*e*n+.2*m,u=v(g)}function w(){var e=Date.now()-c,n=!1,t=0,o=0;l&&(.5<(t=-l*Math.exp(-e/y))||t<-.5?n=!0:t=l=0),p&&(.5<(o=-p*Math.exp(-e/y))||o<-.5?n=!0:o=p=0),n&&(i(s+t,d+o),h=v(w))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,n,t){n.exports=function(t,e){if(!(t instanceof SVGElement))throw new Error("svg element is required for svg.panzoom to work");var o=t.ownerSVGElement;if(!o)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");e.disableKeyboardInteraction||o.setAttribute("tabindex",0);return{getBBox:function(){var e=t.getBBox();return{left:e.x,top:e.y,width:e.width,height:e.height}},getScreenCTM:function(){var e=o.getCTM();return e||o.getScreenCTM()},getOwner:function(){return o},applyTransform:function(e){t.setAttribute("transform","matrix("+e.scale+" 0 0 "+e.scale+" "+e.x+" "+e.y+")")},initTransform:function(e){var n=t.getCTM();e.x=n.e,e.y=n.f,e.scale=n.a,o.removeAttributeNS(null,"viewBox")}}}},{}],6:[function(e,n,t){n.exports=function(){this.x=0,this.y=0,this.scale=1}},{}],7:[function(e,n,t){var e=e("bezier-easing"),p={ease:e(.25,.1,.25,1),easeIn:e(.42,0,1,1),easeOut:e(0,0,.58,1),easeInOut:e(.42,0,.58,1),linear:e(0,0,1,1)};function h(){}function o(){var n=new Set,t=new Set,o=0;return{next:e,cancel:e,clearAll:function(){n.clear(),t.clear(),cancelAnimationFrame(o),o=0}};function e(e){t.add(e),o=o||requestAnimationFrame(r)}function r(){o=0;var e=t;t=n,(n=e).forEach(function(e){e()}),n.clear()}}n.exports=function(t,n,e){var o=Object.create(null),r=Object.create(null),i="function"==typeof(e=e||{}).easing?e.easing:p[e.easing];i||(e.easing&&console.warn("Unknown easing function in amator: "+e.easing),i=p.ease);var a="function"==typeof e.step?e.step:h,c="function"==typeof e.done?e.done:h,u=function(e){if(!e)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}};if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}(e.scheduler),f=Object.keys(n);f.forEach(function(e){o[e]=t[e],r[e]=n[e]-t[e]});var s,e="number"==typeof e.duration?e.duration:400,l=Math.max(1,.06*e),m=0;return s=u.next(function e(){var n=i(m/l);m+=1;d(n);m<=l?(s=u.next(e),a(t)):(s=0,setTimeout(function(){c(t)},0))}),{cancel:function(){u.cancel(s),s=0}};function d(n){f.forEach(function(e){t[e]=r[e]*n+o[e]})}},n.exports.makeAggregateRaf=o,n.exports.sharedScheduler=o()},{"bezier-easing":8}],8:[function(e,n,t){var u=4,f=1e-7,s=10,r="function"==typeof Float32Array;function o(e,n){return 1-3*n+3*e}function l(e,n,t){return((o(n,t)*e+(3*t-6*n))*e+3*n)*e}function m(e,n,t){return 3*o(n,t)*e*e+2*(3*t-6*n)*e+3*n}function d(e){return e}n.exports=function(i,n,a,t){if(!(0<=i&&i<=1&&0<=a&&a<=1))throw new Error("bezier x values must be in [0, 1] range");if(i===n&&a===t)return d;for(var c=new(r?Float32Array:Array)(11),e=0;e<11;++e)c[e]=l(.1*e,i,a);function o(e){for(var n=0,t=1;10!==t&&c[t]<=e;++t)n+=.1;var o=n+.1*((e-c[--t])/(c[t+1]-c[t])),r=m(o,i,a);return.001<=r?function(e,n,t,o){for(var r=0;r<u;++r){var i=m(n,t,o);if(0===i)return n;n-=(l(n,t,o)-e)/i}return n}(e,o,i,a):0===r?o:function(e,n,t,o,r){for(var i,a,c=0;0<(i=l(a=n+(t-n)/2,o,r)-e)?t=a:n=a,Math.abs(i)>f&&++c<s;);return a}(e,n,n+.1,i,a)}return function(e){return 0===e?0:1===e?1:l(o(e),n,t)}}},{}],9:[function(e,n,t){n.exports=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],t=0;t<n.length;++t)if(e.hasOwnProperty(n[t]))throw new Error("Subject cannot be eventified, since it already has property '"+n[t]+"'")}(e);var i,a,n=(i=e,a=Object.create(null),{on:function(e,n,t){if("function"!=typeof n)throw new Error("callback is expected to be a function");return(a[e]||(a[e]=[])).push({callback:n,ctx:t}),i},off:function(e,n){if(void 0===e)return a=Object.create(null),i;if(a[e])if("function"!=typeof n)delete a[e];else for(var t=a[e],o=0;o<t.length;++o)t[o].callback===n&&t.splice(o,1);return i},fire:function(e){var n,t=a[e];if(!t)return i;1<arguments.length&&(n=Array.prototype.splice.call(arguments,1));for(var o=0;o<t.length;++o){var r=t[o];r.callback.apply(r.ctx,n)}return i}});return e.on=n.on,e.off=n.off,e.fire=n.fire,e}},{}],10:[function(e,n,t){function o(e,n,t){e.addEventListener("wheel",n,t)}n.exports=o,n.exports.addWheelListener=o,n.exports.removeWheelListener=function(e,n,t){e.removeEventListener("wheel",n,t)}},{}]},{},[1])(1)});